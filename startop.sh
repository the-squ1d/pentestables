#!/bin/sh

#check if we are resuming op by seeing if client already exists
if [ -e ~/ops_scripts/var/client ]; then
	#resume op, read client var
	client=$(cat ~/ops_scripts/var/client)
	echo "I see you are resuming an op and the client is $client."
	sleep 2
#looks like we aren't resuming op
else
	#grab client name
	echo "Enter client name: "
	read client
	
	#ensure $client string isn't empty
	if [ -z "$client" ]; then
		echo "You didn't enter anything. Try again:" & read client
	fi

	#save client name to var
	echo $client > ~/ops_scripts/var/client
	
	#create a directory to save client data
	mkdir ~/data/$client

	#create opnotes
	echo "========================================================================" >> ~/data/$client/opnotes.txt
	echo "====== Operations Notes for $client                              =======" >> ~/data/$client/opnotes.txt
	echo "========================================================================" >> ~/data/$client/opnotes.txt
	echo "" >> ~/data/$client/opnotes.txt
	echo "" >> ~/data/$client/opnotes.txt
	echo "" >> ~/data/$client/opnotes.txt
	echo "- Target List: -" >> ~/data/$client/opnotes.txt
	echo "----------------" >> ~/data/$client/opnotes.txt
	echo "-> $(wget -qO- ifconfig.co)" >> ~/data/$client/opnotes.txt
	echo "--> TARGET 1" >> ~/data/$client/opnotes.txt
	echo "" >> ~/data/$client/opnotes.txt
	echo "" >> ~/data/$client/opnotes.txt
	echo "========================================================================" >> ~/data/$client/opnotes.txt
	echo "----------------" >> ~/data/$client/opnotes.txt
	echo "-   Target 1   -" >> ~/data/$client/opnotes.txt
	echo "----------------" >> ~/data/$client/opnotes.txt
	echo "notes go here, USE TIMESTAMPS" >> ~/data/$client/opnotes.txt

fi

#start tcpdump
echo "Starting tcpdump."
nohup tcpdump -i any -w ~/data/$client/$(date +%Y%m%d%H%M).pcap &
sleep 2

#open opnotes.txt
echo "Opening opnotes."
sleep 2
vi ~/data/$client/opnotes.txt
